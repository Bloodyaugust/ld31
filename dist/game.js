/*! ld31 07-12-2014 */
function logPlay(){_gaq.push(["_trackEvent","Button","Play"])}function start(){var a=new Date;window.app=new SL.Game({canvas:document.getElementById("GameCanvas")}),app.assetCollection=new SL.AssetCollection("res/assets.json",app,function(){_gaq.push(["_trackEvent","Game","Load","",(new Date-a)/1e3]),$(".canvas-container").append(domjs.build(templates.modal));var b=new SL.Scene("loading",[],function(){},app);b.addEntity(new SL.Loader({assetCollection:app.assetCollection,screenSize:SCREEN_SIZE,loadCallback:function(){app.transitionScene("menu")},barColor:"blue",textColor:"green"}));var c=new SL.Scene("menu",[],function(){var a=$(".modal");a.append(domjs.build(templates.menu)),$(".menu .button").on("click",function(){a.empty(),a.off(),app.transitionScene($(this).attr("id"))})},app),d=new SL.Scene("game",[],function(){var a=$(".modal");a.empty(),a.off(),a.hide(),app.currentScene.addEntity(new Spawner),app.currentScene.addEntity(new Player)},app);app.addScene(b),app.addScene(c),app.addScene(d),app.transitionScene("loading"),app.start()})}function Caroler(a){var b=this,c=app.assetCollection.assets.carolers[a.type];b.type=a.type||"caroler",b.sprite=new PIXI.Sprite(app.assetCollection.getTexture(a.type)),b.path=a.path,b.sprite.anchor.x=.5,b.sprite.anchor.y=.5,b.sprite.position.x=a.position.x,b.sprite.position.y=a.position.y,b.sprite.rotation=0,b.collider=new SL.Rect(a.position,new SL.Vec2(50,100)),b.apparentSize=SL.Tween.lerp(.5,1,b.collider.origin.y/SCREEN_SIZE.y),b.pathPoint=0,b.isDead=!1,b.collider.translate(new SL.Vec2(0,-50));for(var d in c)c.hasOwnProperty(d)&&(b[d]=c[d]);b.update=function(){var a=b.path[b.pathPoint].distance(b.collider.origin),c=b.collider.origin.getDirectionVector(b.path[b.pathPoint]),d=b.speed*app.deltaTime*b.apparentSize;a>d?b.collider.translate(c.scale(d)):b.pathPoint===b.path.length-1?b.isDead=!0:(b.collider.setLocation(b.path[b.pathPoint].getTranslated(b.collider.size.getScaled(-.5))),b.collider.translate(b.collider.origin.getDirectionVector(b.path[++b.pathPoint]).scale(d-a))),b.sprite.position.x=b.collider.origin.x,b.sprite.position.y=b.collider.origin.y,b.apparentSize=SL.Tween.lerp(.5,1,b.collider.origin.y/SCREEN_SIZE.y),b.sprite.scale=new PIXI.Point(b.apparentSize,b.apparentSize),b.collider=new SL.Rect(b.collider.location,new SL.Vec2(50,100).scale(b.apparentSize)),b.isDead&&app.currentScene.removeEntity(b)}}function Spawner(){function a(){var a,b=Math.random();switch(!0){case b>=0&&.5>=b:a="caroler";break;case b>.5&&.75>=b:a="snowman";break;case b>.75&&.9>=b:a="santa";break;case b>.9&&1>=b:a="elf"}return a}var b=this;b.timeToSpawn=3,b.spawnInterval=2,b.spawnpoints=[new SL.Vec2(-50,200),new SL.Vec2(800,200),new SL.Vec2(-50,400),new SL.Vec2(800,400)],b.paths=[[new SL.Vec2(400,200),new SL.Vec2(400,600)],[new SL.Vec2(400,200),new SL.Vec2(400,600)],[new SL.Vec2(400,400),new SL.Vec2(400,600)],[new SL.Vec2(400,400),new SL.Vec2(400,600)]],b.update=function(){var c;b.timeToSpawn-=app.deltaTime,b.timeToSpawn<=0&&(c=Math.floor(4*Math.random()),app.currentScene.addEntity(new Caroler({type:a(),position:b.spawnpoints[c],path:b.paths[c]})),b.timeToSpawn=b.spawnInterval)}}function Player(){var a=this;a.health=10,a.clipSize=7,a.clip=a.clipSize,a.reloadTime=1,a.timeToReload=0,a.sprite=new PIXI.Sprite(app.assetCollection.getTexture("scope")),a.sprite.anchor.x=.5,a.sprite.anchor.y=.5,a.sprite.position.x=0,a.sprite.position.y=0,a.index=0,a.update=function(){a.sprite.position.x=app.mouseLocation.x,a.sprite.position.y=app.mouseLocation.y,app.currentScene.stage.setChildIndex(a.sprite,app.currentScene.stage.children.length-1)}}SL=sugarLab;var SCREEN_SIZE=new SL.Vec2(800,600);